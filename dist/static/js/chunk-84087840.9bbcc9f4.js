(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-84087840"],{"2dd0":function(e,o,t){},7732:function(e,o,t){"use strict";t.r(o);var s=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"goods-container"},[t("el-form",{staticClass:"search",attrs:{inline:""}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"商品名称"},model:{value:e.searchObj.goods_name,callback:function(o){e.$set(e.searchObj,"goods_name",o)},expression:"searchObj.goods_name"}})],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"一级分类"},model:{value:e.searchObj.category1Id,callback:function(o){e.$set(e.searchObj,"category1Id",o)},expression:"searchObj.category1Id"}},e._l(e.category1List,(function(e){return t("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"二级分类"},model:{value:e.searchObj.category2Id,callback:function(o){e.$set(e.searchObj,"category2Id",o)},expression:"searchObj.category2Id"}},e._l(e.category2List,(function(e){return t("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),t("el-button",{staticClass:"btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.findGoods}},[e._v("查询")]),t("el-button",{staticClass:"btn",attrs:{type:"info"},on:{click:e.resetSearch}},[e._v("清空")])],1),t("el-button",{staticClass:"addBtn",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.openAddGoods}},[e._v("新增商品")]),t("el-dialog",{attrs:{title:e.titleName,visible:e.dialogFormVisible,width:"700px","lock-scroll":!1,"before-close":e.closeDialog},on:{"update:visible":function(o){e.dialogFormVisible=o}}},[t("el-form",{ref:"addOrUpdateGoods",attrs:{model:e.goodsInfo,"label-width":"120px",rules:e.addOrUpdateGoodsRules,inline:!0}},[t("el-form-item",{staticStyle:{width:"90%"},attrs:{label:"商品名称：",prop:"goods_name"}},[t("el-input",{ref:"goods_name",staticStyle:{width:"265%"},attrs:{placeholder:"请输入商品名称",autocomplete:"off",name:"goods_name",type:"text",maxlength:"20"},model:{value:e.goodsInfo.goods_name,callback:function(o){e.$set(e.goodsInfo,"goods_name",o)},expression:"goodsInfo.goods_name"}})],1),t("el-form-item",{attrs:{label:"一级分类："}},[t("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品一级分类"},model:{value:e.category11Id,callback:function(o){e.category11Id=o},expression:"category11Id"}},e._l(e.category1List,(function(e){return t("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"二级分类：",prop:"goods_category_id","label-width":"105px"}},[t("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品二级分类",disabled:e.category22List.length<=0},model:{value:e.goodsInfo.goods_category_id,callback:function(o){e.$set(e.goodsInfo,"goods_category_id",o)},expression:"goodsInfo.goods_category_id"}},e._l(e.category22List,(function(e){return t("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"商品单价(元)",prop:"goods_price"}},[t("el-input-number",{attrs:{precision:2,step:.1},model:{value:e.goodsInfo.goods_price,callback:function(o){e.$set(e.goodsInfo,"goods_price",o)},expression:"goodsInfo.goods_price"}})],1),t("el-form-item",{attrs:{label:"商品库存(个/斤)",prop:"goods_num","label-width":"125px"}},[t("el-input-number",{attrs:{label:"商品库存(个/斤)"},model:{value:e.goodsInfo.goods_num,callback:function(o){e.$set(e.goodsInfo,"goods_num",o)},expression:"goodsInfo.goods_num"}})],1),t("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品图片"}},[t("el-upload",{ref:"upload",attrs:{action:"/api/goods/upload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"auto-upload":!1,"file-list":e.fileListt,"on-success":e.onSuccess}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(o){e.dialogVisible=o}}},[t("img",{attrs:{width:"100%",src:e.goodsImg,alt:""}})])],1),t("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品描述：",prop:"goods_introduction"}},[t("el-input",{ref:"goods_introduction",staticStyle:{width:"260%"},attrs:{placeholder:"请输入商品描述",autocomplete:"off",name:"goods_introduction",type:"textarea",rows:4},model:{value:e.goodsInfo.goods_introduction,callback:function(o){e.$set(e.goodsInfo,"goods_introduction",o)},expression:"goodsInfo.goods_introduction"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(o){return e.addOrUpdateGoods("addOrUpdateGoods")}}},[e._v("确 定")])],1)],1),t("el-table",{staticClass:"goodsTable",attrs:{data:e.goodsList,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"goods_img",label:"商品图片",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(o){var s=o.row;return[t("el-carousel",{staticStyle:{width:"120px",margin:"0 auto"},attrs:{"indicator-position":"outside",arrow:"never",height:"120px"}},e._l(s.goods_img,(function(o,s){return t("el-carousel-item",{key:s},[t("img",{staticStyle:{width:"120px",height:"120px"},attrs:{src:""+e.srcUrl+o}})])})),1)]}}])}),t("el-table-column",{attrs:{prop:"goods_name",label:"商品名称",align:"center",width:"135"}}),t("el-table-column",{attrs:{label:"商品分类",align:"center",width:"125"},scopedSlots:e._u([{key:"default",fn:function(o){var s=o.row;return[t("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(s.secondaryCategory.oneCategory.category_name))]),t("span",{staticStyle:{"margin-right":"5px"}},[e._v("/")]),t("span",[e._v(e._s(s.secondaryCategory.category_name))])]}}])}),t("el-table-column",{attrs:{prop:"goods_price",label:"商品单价(元)",align:"center",width:"135"}}),t("el-table-column",{attrs:{prop:"goods_num",label:"商品库存(个/斤)",align:"center",width:"135"}}),t("el-table-column",{attrs:{prop:"goods_introduction",label:"商品描述",align:"center"}}),t("el-table-column",{attrs:{prop:"goods_state",label:"商品状态",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(o){var s=o.row;return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架"},on:{change:function(o){return e.changeGoodsStatus(s,o)}},model:{value:s.goods_state,callback:function(o){e.$set(s,"goods_state",o)},expression:"row.goods_state"}})]}}])}),t("el-table-column",{attrs:{label:"设置",align:"center",width:"230"},scopedSlots:e._u([{key:"default",fn:function(o){var s=o.row;return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(o){return e.openUpdateGoods(s)}}},[e._v("修改")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(o){return e.deleteGoods(s)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.pageNum,"pager-count":5,"page-sizes":[3,5,7],"page-size":e.pageSize,layout:" prev, pager,  next, sizes,jumper,->,total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getGoodsList}})],1)],1)},a=[],n=t("5530"),r=t("b85c"),i=t("c7eb"),c=t("1da1"),d=(t("ac1f"),t("00b4"),t("99af"),t("e9c4"),t("b0c0"),t("2f62")),l={name:"Goods",data:function(){var e=function(e,o,t){var s=/^[\u4E00-\u9FA5A-Za-z0-9_]+$/;o?s.test(o)?t():t(new Error("商品名称要求不包括特殊字符")):t(new Error("商品名称不能为空！"))},o=function(e,o,t){o?t():t(new Error("商品分类不能为空！"))},t=function(e,o,t){o?t():t(new Error("商品单价不能为空！"))},s=function(e,o,t){o?t():t(new Error("商品库存不能为空！"))},a=function(e,o,t){o?t():t(new Error("商品描述不能为空"))};return{searchObj:{goods_name:"",category1Id:null,category2Id:null},tempSearchObj:{goods_name:"",category1Id:null,category2Id:null},copeGoodsInfo:{},goodsInfo:{id:null,goods_name:"",goods_num:null,goods_price:null,goods_introduction:"",goods_category_id:null,goods_img:[]},category11Id:null,category22List:[],fileListt:[],goodsImg:"",pageNum:1,pageSize:5,titleName:"新增商品",dialogFormVisible:!1,dialogVisible:!1,addOrUpdateGoodsRules:{goods_name:[{required:!0,trigger:"blur",validator:e}],goods_category_id:[{required:!0,trigger:"blur",validator:o}],goods_price:[{required:!0,trigger:"blur",validator:t}],goods_num:[{required:!0,trigger:"blur",validator:s}],goods_introduction:[{required:!0,trigger:"blur",validator:a}]}}},mounted:function(){this.getGoodsList(),this.getCategoryList()},methods:{getGoodsList:function(){var e=arguments,o=this;return Object(c["a"])(Object(i["a"])().mark((function t(){var s,a,n,r,c,d,l,g;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.length>0&&void 0!==e[0]?e[0]:1,o.pageNum=s,a=o.pageSize,n=o.pageNum,r=o.tempSearchObj,c=r.goods_name,d=r.category1Id,l=r.category2Id,g={pageSize:a,pageNum:n},c&&Object.assign(g,{goods_name:c}),d&&Object.assign(g,{category1Id:d}),l&&Object.assign(g,{goods_category_id:l}),t.prev=8,!d||l){t.next=14;break}return t.next=12,o.$store.dispatch("goods/getCategorySearchList",g);case 12:t.next=16;break;case 14:return t.next=16,o.$store.dispatch("goods/getGoodsList",g);case 16:o.$message({type:"success",message:"获取商品列表成功"}),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](8),o.$message({type:"error",message:t.t0});case 22:case"end":return t.stop()}}),t,null,[[8,19]])})))()},getCategoryList:function(){var e=this;return Object(c["a"])(Object(i["a"])().mark((function o(){return Object(i["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,e.$store.dispatch("category/getCategoryList");case 3:e.$message({type:"success",message:"获取商品分类列表成功"}),o.next=9;break;case 6:o.prev=6,o.t0=o["catch"](0),e.$message({type:"error",message:o.t0});case 9:case"end":return o.stop()}}),o,null,[[0,6]])})))()},handleSizeChange:function(e){this.pageSize=e,this.getGoodsList()},findGoods:function(){var e=this.searchObj,o=e.goods_name,t=e.category1Id,s=e.category2Id;this.tempSearchObj={goods_name:o,category1Id:t,category2Id:s},this.getGoodsList()},resetSearch:function(){this.searchObj={goods_name:"",category1Id:null,category2Id:null},this.tempSearchObj={goods_name:"",category1Id:null,category2Id:null},this.getGoodsList()},closeDialog:function(){this.dialogFormVisible=!1,this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.category11Id=null,this.category22List=[],this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null,this.fileListt=[],this.$refs.addOrUpdateGoods.resetFields()},onSuccess:function(e,o,t){this.fileListt=t,this.goodsInfo.goods_img.push(e.result.goodsImg)},handleRemove:function(e,o){this.fileListt=o},handlePictureCardPreview:function(e){this.goodsImg=e.url,this.dialogVisible=!0},openAddGoods:function(){this.titleName="新增商品",this.dialogFormVisible=!0,this.fileListt=[],this.category11Id=null,this.category22List=[],this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null},openUpdateGoods:function(e){this.dialogFormVisible=!0,this.titleName="修改商品";var o,t=Object(r["a"])(e.goods_img);try{for(t.s();!(o=t.n()).done;){var s=o.value,a={name:"".concat(s),url:"".concat(this.srcUrl).concat(s)};this.fileListt.push(a)}}catch(i){t.e(i)}finally{t.f()}this.goodsInfo.goods_name=e.goods_name,this.goodsInfo.goods_category_id=e.goods_category_id,this.goodsInfo.goods_introduction=e.goods_introduction,this.goodsInfo.goods_price=e.goods_price,this.goodsInfo.goods_num=e.goods_num,this.goodsInfo.goods_img=e.goods_img,this.category22List=[],this.category11Id=e.secondaryCategory.oneCategory.id,this.goodsInfo.id=e.id,this.copeGoodsInfo=Object(n["a"])({},this.goodsInfo)},addOrUpdateGoods:function(e){var o=this;this.$refs[e].validate(function(){var e=Object(c["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,o.$refs.upload.submit();case 3:setTimeout(Object(c["a"])(Object(i["a"])().mark((function e(){var t,s,a,c,d,l,g,u,p,f,m,h,_;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t=o.goodsInfo,s=t.goods_name,a=t.goods_price,c=t.goods_num,d=t.goods_introduction,l=t.goods_category_id,g=t.goods_img,u={goods_name:s,goods_price:a,goods_num:c,goods_introduction:d,goods_category_id:l,goods_img:"".concat(g)},"新增商品"!=o.titleName){e.next=8;break}return e.next=6,o.$store.dispatch("goods/addGoods",u);case 6:e.next=21;break;case 8:if("修改商品"!=o.titleName){e.next=21;break}u.goods_img=[],p=Object(r["a"])(o.fileListt);try{for(p.s();!(f=p.n()).done;)m=f.value,m.response?u.goods_img.push(m.response.result.goodsImg):u.goods_img.push(m.name)}catch(i){p.e(i)}finally{p.f()}if(u.goods_img="".concat(u.goods_img),h=Object(n["a"])({id:o.goodsInfo.id},u),_={id:o.copeGoodsInfo.id,goods_name:o.copeGoodsInfo.goods_name,goods_price:1*o.copeGoodsInfo.goods_price,goods_num:o.copeGoodsInfo.goods_num,goods_introduction:o.copeGoodsInfo.goods_introduction,goods_category_id:o.copeGoodsInfo.goods_category_id,goods_img:"".concat(o.copeGoodsInfo.goods_img)},JSON.stringify(_)!==JSON.stringify(h)){e.next=19;break}return o.$message({type:"info",message:"已取消"}),o.closeDialog(),e.abrupt("return");case 19:return e.next=21,o.$store.dispatch("goods/updateGoods",h);case 21:o.$message({type:"success",message:"".concat(o.titleName,"成功")}),o.getGoodsList(o.pageNum),e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](0),o.$message({type:"error",message:e.t0});case 28:o.closeDialog();case 29:case"end":return e.stop()}}),e,null,[[0,25]])}))),3e3),o.dialogFormVisible=!1;case 5:case"end":return e.stop()}}),e)})));return function(o){return e.apply(this,arguments)}}())},changeGoodsStatus:function(e,o){var t=this;return Object(c["a"])(Object(i["a"])().mark((function s(){var a,n,r;return Object(i["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a="",n=0,o?(n=1,a="上架"):(a="下架",n=0),r={id:e.id,goods_state:n},s.prev=4,s.next=7,t.$store.dispatch("goods/updateGoodsStatus",r);case 7:t.$message({type:"success",message:"".concat(a,"成功")}),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](4),t.$message({type:"error",message:s.t0});case 13:case"end":return s.stop()}}),s,null,[[4,10]])})))()},deleteGoods:function(e){var o=this;return Object(c["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:o.$confirm("确定删除商品 '".concat(e.goods_name,"' 吗?"),"提示",{type:"warning"}).then(Object(c["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.$store.dispatch("goods/deleteGoods",{ids:[e.id]});case 2:t.sent,o.getGoodsList(1===o.goodsList.length?o.pageNum-1:o.pageNum),o.$message({type:"success",message:"删除商品成功"});case 5:case"end":return t.stop()}}),t)})))).catch((function(e){"cancel"==e?o.$message.info("已取消删除"):o.$message({type:"error",message:e})}));case 1:case"end":return t.stop()}}),t)})))()}},computed:Object(n["a"])({},Object(d["c"])({goodsList:function(e){return e.goods.goodsList},total:function(e){return e.goods.total},category1List:function(e){return e.category.category1List},category2List:function(e){return e.category.category2List}})),watch:{category11Id:function(){this.category22List=this.category1List[this.category11Id-1<0?0:this.category11Id-1].secondaryCategory||[]}}},g=l,u=(t("e4df"),t("b4ff"),t("2877")),p=Object(u["a"])(g,s,a,!1,null,"dae2d94c",null);o["default"]=p.exports},b4ff:function(e,o,t){"use strict";t("e7fb")},e4df:function(e,o,t){"use strict";t("2dd0")},e7fb:function(e,o,t){},e9c4:function(e,o,t){var s=t("23e7"),a=t("d066"),n=t("d039"),r=a("JSON","stringify"),i=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,d=/^[\uDC00-\uDFFF]$/,l=function(e,o,t){var s=t.charAt(o-1),a=t.charAt(o+1);return c.test(e)&&!d.test(a)||d.test(e)&&!c.test(s)?"\\u"+e.charCodeAt(0).toString(16):e},g=n((function(){return'"\\udf06\\ud834"'!==r("\udf06\ud834")||'"\\udead"'!==r("\udead")}));r&&s({target:"JSON",stat:!0,forced:g},{stringify:function(e,o,t){var s=r.apply(null,arguments);return"string"==typeof s?s.replace(i,l):s}})}}]);