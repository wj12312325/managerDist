(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f1decce"],{7732:function(o,e,t){"use strict";t.r(e);var s=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"goods-container"},[t("el-form",{staticClass:"search",attrs:{inline:""}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"商品名称"},model:{value:o.searchObj.goods_name,callback:function(e){o.$set(o.searchObj,"goods_name",e)},expression:"searchObj.goods_name"}})],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"一级分类"},model:{value:o.searchObj.category1Id,callback:function(e){o.$set(o.searchObj,"category1Id",e)},expression:"searchObj.category1Id"}},o._l(o.category1List,(function(o){return t("el-option",{key:o.id,attrs:{label:o.category_name,value:o.id}})})),1)],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"二级分类"},model:{value:o.searchObj.category2Id,callback:function(e){o.$set(o.searchObj,"category2Id",e)},expression:"searchObj.category2Id"}},o._l(o.category2List,(function(o){return t("el-option",{key:o.id,attrs:{label:o.category_name,value:o.id}})})),1)],1),t("el-button",{staticClass:"btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:o.findGoods}},[o._v("查询")]),t("el-button",{staticClass:"btn",attrs:{type:"info"},on:{click:o.resetSearch}},[o._v("清空")])],1),t("el-button",{staticClass:"addBtn",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:o.openAddGoods}},[o._v("新增商品")]),t("el-dialog",{attrs:{title:o.titleName,visible:o.dialogFormVisible,width:"700px","lock-scroll":!1,"before-close":o.closeDialog},on:{"update:visible":function(e){o.dialogFormVisible=e}}},[t("el-form",{ref:"addOrUpdateGoods",attrs:{model:o.goodsInfo,"label-width":"120px",rules:o.addOrUpdateGoodsRules,inline:!0}},[t("el-form-item",{staticStyle:{width:"90%"},attrs:{label:"商品名称：",prop:"goods_name"}},[t("el-input",{ref:"goods_name",staticStyle:{width:"265%"},attrs:{placeholder:"请输入商品名称",autocomplete:"off",name:"goods_name",type:"text",maxlength:"20"},model:{value:o.goodsInfo.goods_name,callback:function(e){o.$set(o.goodsInfo,"goods_name",e)},expression:"goodsInfo.goods_name"}})],1),t("el-form-item",{attrs:{label:"一级分类："}},[t("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品一级分类"},model:{value:o.category11Id,callback:function(e){o.category11Id=e},expression:"category11Id"}},o._l(o.category1List,(function(o){return t("el-option",{key:o.id,attrs:{label:o.category_name,value:o.id}})})),1)],1),t("el-form-item",{attrs:{label:"二级分类：",prop:"goods_category_id","label-width":"105px"}},[t("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品二级分类",disabled:o.category22List.length<=0},model:{value:o.goodsInfo.goods_category_id,callback:function(e){o.$set(o.goodsInfo,"goods_category_id",e)},expression:"goodsInfo.goods_category_id"}},o._l(o.category22List,(function(o){return t("el-option",{key:o.id,attrs:{label:o.category_name,value:o.id}})})),1)],1),t("el-form-item",{attrs:{label:"商品单价(元)",prop:"goods_price"}},[t("el-input-number",{attrs:{precision:2,step:.1},model:{value:o.goodsInfo.goods_price,callback:function(e){o.$set(o.goodsInfo,"goods_price",e)},expression:"goodsInfo.goods_price"}})],1),t("el-form-item",{attrs:{label:"商品库存(个/斤)",prop:"goods_num","label-width":"125px"}},[t("el-input-number",{attrs:{label:"商品库存(个/斤)"},model:{value:o.goodsInfo.goods_num,callback:function(e){o.$set(o.goodsInfo,"goods_num",e)},expression:"goodsInfo.goods_num"}})],1),t("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品图片"}},[t("el-upload",{ref:"upload",attrs:{action:"/api/goods/upload","list-type":"picture-card","on-preview":o.handlePictureCardPreview,"on-remove":o.handleRemove,"auto-upload":!1,"file-list":o.fileListt,"on-success":o.onSuccess}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:o.dialogVisible,width:"500px"},on:{"update:visible":function(e){o.dialogVisible=e}}},[t("img",{attrs:{width:"100%",src:o.goodsImg,alt:""}})])],1),t("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品描述：",prop:"goods_introduction"}},[t("el-input",{ref:"goods_introduction",staticStyle:{width:"260%"},attrs:{placeholder:"请输入商品描述",autocomplete:"off",name:"goods_introduction",type:"textarea",rows:4},model:{value:o.goodsInfo.goods_introduction,callback:function(e){o.$set(o.goodsInfo,"goods_introduction",e)},expression:"goodsInfo.goods_introduction"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:o.closeDialog}},[o._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(e){return o.addOrUpdateGoods("addOrUpdateGoods")}}},[o._v("确 定")])],1)],1),t("el-table",{staticClass:"goodsTable",attrs:{data:o.goodsList,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"goods_img",label:"商品图片",align:"center",width:"180"},scopedSlots:o._u([{key:"default",fn:function(e){var s=e.row;return[t("el-carousel",{staticStyle:{width:"120px",margin:"0 auto"},attrs:{"indicator-position":"outside",arrow:"never",height:"120px"}},o._l(s.goods_img,(function(e,s){return t("el-carousel-item",{key:s},[t("img",{staticStyle:{width:"120px",height:"120px"},attrs:{src:""+o.srcUrl+e}})])})),1)]}}])}),t("el-table-column",{attrs:{prop:"goods_name",label:"商品名称",align:"center",width:"135"}}),t("el-table-column",{attrs:{label:"商品分类",align:"center",width:"125"},scopedSlots:o._u([{key:"default",fn:function(e){var s=e.row;return[t("span",{staticStyle:{"margin-right":"5px"}},[o._v(o._s(s.secondaryCategory.oneCategory.category_name))]),t("span",{staticStyle:{"margin-right":"5px"}},[o._v("/")]),t("span",[o._v(o._s(s.secondaryCategory.category_name))])]}}])}),t("el-table-column",{attrs:{prop:"goods_price",label:"商品单价(元)",align:"center",width:"135"}}),t("el-table-column",{attrs:{prop:"goods_num",label:"商品库存(个/斤)",align:"center",width:"135"}}),t("el-table-column",{attrs:{prop:"goods_introduction",label:"商品描述",align:"center"}}),t("el-table-column",{attrs:{prop:"goods_state",label:"商品状态",align:"center",width:"140"},scopedSlots:o._u([{key:"default",fn:function(e){var s=e.row;return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架"},on:{change:function(e){return o.changeGoodsStatus(s,e)}},model:{value:s.goods_state,callback:function(e){o.$set(s,"goods_state",e)},expression:"row.goods_state"}})]}}])}),t("el-table-column",{attrs:{label:"设置",align:"center",width:"230"},scopedSlots:o._u([{key:"default",fn:function(e){var s=e.row;return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(e){return o.openUpdateGoods(s)}}},[o._v("修改")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(e){return o.deleteGoods(s)}}},[o._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":o.pageNum,"pager-count":5,"page-sizes":[3,5,7],"page-size":o.pageSize,layout:" prev, pager,  next, sizes,jumper,->,total",total:o.total},on:{"size-change":o.handleSizeChange,"current-change":o.getGoodsList}})],1)],1)},a=[],n=t("5530"),i=t("b85c"),r=t("c7eb"),c=t("1da1"),d=(t("ac1f"),t("00b4"),t("e9c4"),t("99af"),t("b0c0"),t("2f62")),l={name:"Goods",data:function(){var o=function(o,e,t){var s=/^[\u4E00-\u9FA5A-Za-z0-9_]+$/;e?s.test(e)?t():t(new Error("商品名称要求不包括特殊字符")):t(new Error("商品名称不能为空！"))},e=function(o,e,t){e?t():t(new Error("商品分类不能为空！"))},t=function(o,e,t){e?t():t(new Error("商品单价不能为空！"))},s=function(o,e,t){e?t():t(new Error("商品库存不能为空！"))},a=function(o,e,t){e?t():t(new Error("商品描述不能为空"))};return{searchObj:{goods_name:"",category1Id:null,category2Id:null},tempSearchObj:{goods_name:"",category1Id:null,category2Id:null},copeGoodsInfo:{},goodsInfo:{id:null,goods_name:"",goods_num:null,goods_price:null,goods_introduction:"",goods_category_id:null,goods_img:[]},category11Id:null,category22List:[],fileListt:[],goodsImg:"",pageNum:1,pageSize:5,titleName:"新增商品",dialogFormVisible:!1,dialogVisible:!1,addOrUpdateGoodsRules:{goods_name:[{required:!0,trigger:"blur",validator:o}],goods_category_id:[{required:!0,trigger:"blur",validator:e}],goods_price:[{required:!0,trigger:"blur",validator:t}],goods_num:[{required:!0,trigger:"blur",validator:s}],goods_introduction:[{required:!0,trigger:"blur",validator:a}]}}},mounted:function(){this.getGoodsList(),this.getCategoryList()},methods:{getGoodsList:function(){var o=arguments,e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){var s,a,n,i,c,d,l,g;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=o.length>0&&void 0!==o[0]?o[0]:1,e.pageNum=s,a=e.pageSize,n=e.pageNum,i=e.tempSearchObj,c=i.goods_name,d=i.category1Id,l=i.category2Id,g={pageSize:a,pageNum:n},c&&Object.assign(g,{goods_name:c}),d&&Object.assign(g,{category1Id:d}),l&&Object.assign(g,{goods_category_id:l}),t.prev=8,!d||l){t.next=14;break}return t.next=12,e.$store.dispatch("goods/getCategorySearchList",g);case 12:t.next=16;break;case 14:return t.next=16,e.$store.dispatch("goods/getGoodsList",g);case 16:e.$message({type:"success",message:"获取商品列表成功"}),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](8),e.$message({type:"error",message:t.t0});case 22:case"end":return t.stop()}}),t,null,[[8,19]])})))()},getCategoryList:function(){var o=this;return Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.$store.dispatch("category/getCategoryList");case 3:o.$message({type:"success",message:"获取商品分类列表成功"}),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),o.$message({type:"error",message:e.t0});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},handleSizeChange:function(o){this.pageSize=o,this.getGoodsList()},findGoods:function(){var o=this.searchObj,e=o.goods_name,t=o.category1Id,s=o.category2Id;this.tempSearchObj={goods_name:e,category1Id:t,category2Id:s},this.getGoodsList()},resetSearch:function(){this.searchObj={goods_name:"",category1Id:null,category2Id:null},this.tempSearchObj={goods_name:"",category1Id:null,category2Id:null},this.getGoodsList()},closeDialog:function(){this.dialogFormVisible=!1,this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.category11Id=null,this.category22List=[],this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null,this.fileListt=[],this.$refs.addOrUpdateGoods.resetFields()},onSuccess:function(o,e,t){this.fileListt=t,this.goodsInfo.goods_img.push(o.result.goodsImg)},handleRemove:function(o,e){this.fileListt=e},handlePictureCardPreview:function(o){this.goodsImg=o.url,this.dialogVisible=!0},openAddGoods:function(){this.titleName="新增商品",this.dialogFormVisible=!0,this.fileListt=[],this.category11Id=null,this.category22List=[],this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null},openUpdateGoods:function(o){this.dialogFormVisible=!0,this.titleName="修改商品";var e,t=Object(i["a"])(o.goods_img);try{for(t.s();!(e=t.n()).done;){var s=e.value,a={name:"".concat(s),url:"".concat(this.srcUrl).concat(s)};this.fileListt.push(a)}}catch(r){t.e(r)}finally{t.f()}this.goodsInfo.goods_name=o.goods_name,this.goodsInfo.goods_category_id=o.goods_category_id,this.goodsInfo.goods_introduction=o.goods_introduction,this.goodsInfo.goods_price=o.goods_price,this.goodsInfo.goods_num=o.goods_num,this.goodsInfo.goods_img=o.goods_img,this.category22List=[],this.category11Id=o.secondaryCategory.oneCategory.id,this.goodsInfo.id=o.id,this.copeGoodsInfo=Object(n["a"])({},this.goodsInfo),this.copeGoodsInfo=JSON.stringify({id:this.copeGoodsInfo.id,goods_name:this.copeGoodsInfo.goods_name,goods_price:1*this.copeGoodsInfo.goods_price,goods_num:this.copeGoodsInfo.goods_num,goods_introduction:this.copeGoodsInfo.goods_introduction,goods_category_id:this.copeGoodsInfo.goods_category_id,goods_img:"".concat(this.copeGoodsInfo.goods_img)})},addOrUpdateGoods:function(o){var e=this;this.$refs[o].validate(function(){var o=Object(c["a"])(Object(r["a"])().mark((function o(t){return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(!t){o.next=5;break}return o.next=3,e.$refs.upload.submit();case 3:setTimeout(Object(c["a"])(Object(r["a"])().mark((function o(){var t,s,a,c,d,l,g,u,p,f,m,h;return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(o.prev=0,t=e.goodsInfo,s=t.goods_name,a=t.goods_price,c=t.goods_num,d=t.goods_introduction,l=t.goods_category_id,g=t.goods_img,u={goods_name:s,goods_price:a,goods_num:c,goods_introduction:d,goods_category_id:l,goods_img:"".concat(g)},"新增商品"!=e.titleName){o.next=8;break}return o.next=6,e.$store.dispatch("goods/addGoods",u);case 6:o.next=22;break;case 8:if("修改商品"!=e.titleName){o.next=22;break}u.goods_img=[],p=Object(i["a"])(e.fileListt);try{for(p.s();!(f=p.n()).done;)m=f.value,m.response?u.goods_img.push(m.response.result.goodsImg):u.goods_img.push(m.name)}catch(r){p.e(r)}finally{p.f()}if(u.goods_img="".concat(u.goods_img),h=Object(n["a"])({id:e.goodsInfo.id},u),e.copeGoodsInfo!==JSON.stringify(h)){o.next=20;break}return e.$message({type:"info",message:"已取消"}),e.closeDialog(),o.abrupt("return");case 20:return o.next=22,e.$store.dispatch("goods/updateGoods",h);case 22:e.$message({type:"success",message:"".concat(e.titleName,"成功")}),e.getGoodsList(e.pageNum),o.next=29;break;case 26:o.prev=26,o.t0=o["catch"](0),e.$message({type:"error",message:o.t0});case 29:e.closeDialog();case 30:case"end":return o.stop()}}),o,null,[[0,26]])}))),3e3),e.dialogFormVisible=!1;case 5:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}())},changeGoodsStatus:function(o,e){var t=this;return Object(c["a"])(Object(r["a"])().mark((function s(){var a,n,i;return Object(r["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a="",n=0,e?(n=1,a="上架"):(a="下架",n=0),i={id:o.id,goods_state:n},s.prev=4,s.next=7,t.$store.dispatch("goods/updateGoodsStatus",i);case 7:t.$message({type:"success",message:"".concat(a,"成功")}),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](4),t.$message({type:"error",message:s.t0});case 13:case"end":return s.stop()}}),s,null,[[4,10]])})))()},deleteGoods:function(o){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$confirm("确定删除商品 '".concat(o.goods_name,"' 吗?"),"提示",{type:"warning"}).then(Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("goods/deleteGoods",{ids:[o.id]});case 2:t.sent,e.getGoodsList(1===e.goodsList.length?e.pageNum-1:e.pageNum),e.$message({type:"success",message:"删除商品成功"});case 5:case"end":return t.stop()}}),t)})))).catch((function(o){"cancel"==o?e.$message.info("已取消删除"):e.$message({type:"error",message:o})}));case 1:case"end":return t.stop()}}),t)})))()}},computed:Object(n["a"])({},Object(d["c"])({goodsList:function(o){return o.goods.goodsList},total:function(o){return o.goods.total},category1List:function(o){return o.category.category1List},category2List:function(o){return o.category.category2List}})),watch:{category11Id:function(){this.category22List=this.category1List[this.category11Id-1<0?0:this.category11Id-1].secondaryCategory||[]}}},g=l,u=(t("b17b"),t("9b6e"),t("2877")),p=Object(u["a"])(g,s,a,!1,null,"0a2f2628",null);e["default"]=p.exports},"89e1":function(o,e,t){},"9b6e":function(o,e,t){"use strict";t("bb1a")},b17b:function(o,e,t){"use strict";t("89e1")},bb1a:function(o,e,t){},e9c4:function(o,e,t){var s=t("23e7"),a=t("d066"),n=t("d039"),i=a("JSON","stringify"),r=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,d=/^[\uDC00-\uDFFF]$/,l=function(o,e,t){var s=t.charAt(e-1),a=t.charAt(e+1);return c.test(o)&&!d.test(a)||d.test(o)&&!c.test(s)?"\\u"+o.charCodeAt(0).toString(16):o},g=n((function(){return'"\\udf06\\ud834"'!==i("\udf06\ud834")||'"\\udead"'!==i("\udead")}));i&&s({target:"JSON",stat:!0,forced:g},{stringify:function(o,e,t){var s=i.apply(null,arguments);return"string"==typeof s?s.replace(r,l):s}})}}]);