(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74fc8a3c"],{"4ee6":function(e,t,o){"use strict";o("86e8")},"59f2":function(e,t,o){"use strict";o("6b59")},"6b59":function(e,t,o){},7732:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"goods-container"},[o("el-form",{staticClass:"search",attrs:{inline:""}},[o("el-form-item",[o("el-input",{attrs:{placeholder:"商品名称"},model:{value:e.searchObj.goods_name,callback:function(t){e.$set(e.searchObj,"goods_name",t)},expression:"searchObj.goods_name"}})],1),o("el-form-item",[o("el-select",{attrs:{placeholder:"一级分类"},model:{value:e.searchObj.category1Id,callback:function(t){e.$set(e.searchObj,"category1Id",t)},expression:"searchObj.category1Id"}},e._l(e.category1List,(function(e){return o("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),o("el-form-item",[o("el-select",{attrs:{placeholder:"二级分类"},model:{value:e.searchObj.category2Id,callback:function(t){e.$set(e.searchObj,"category2Id",t)},expression:"searchObj.category2Id"}},e._l(e.category2List,(function(e){return o("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),o("el-button",{staticClass:"btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.findGoods}},[e._v("查询")]),o("el-button",{staticClass:"btn",attrs:{type:"info"},on:{click:e.resetSearch}},[e._v("清空")])],1),o("el-button",{staticClass:"addBtn",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.openAddGoods}},[e._v("新增商品")]),o("el-dialog",{attrs:{title:e.titleName,visible:e.dialogFormVisible,width:"700px","lock-scroll":!1,"before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"addOrUpdateGoods",attrs:{model:e.goodsInfo,"label-width":"120px",rules:e.addOrUpdateGoodsRules,inline:!0}},[o("el-form-item",{staticStyle:{width:"90%"},attrs:{label:"商品名称：",prop:"goods_name"}},[o("el-input",{ref:"goods_name",staticStyle:{width:"265%"},attrs:{placeholder:"请输入商品名称",autocomplete:"off",name:"goods_name",type:"text",maxlength:"20"},model:{value:e.goodsInfo.goods_name,callback:function(t){e.$set(e.goodsInfo,"goods_name",t)},expression:"goodsInfo.goods_name"}})],1),o("el-form-item",{attrs:{label:"一级分类："}},[o("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品一级分类"},model:{value:e.category11Id,callback:function(t){e.category11Id=t},expression:"category11Id"}},e._l(e.category1List,(function(e){return o("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),o("el-form-item",{attrs:{label:"二级分类：",prop:"goods_category_id","label-width":"105px"}},[o("el-select",{staticStyle:{width:"88%"},attrs:{placeholder:"请选择商品二级分类",disabled:e.category22List.length<=0},model:{value:e.goodsInfo.goods_category_id,callback:function(t){e.$set(e.goodsInfo,"goods_category_id",t)},expression:"goodsInfo.goods_category_id"}},e._l(e.category22List,(function(e){return o("el-option",{key:e.id,attrs:{label:e.category_name,value:e.id}})})),1)],1),o("el-form-item",{attrs:{label:"商品单价(元)",prop:"goods_price"}},[o("el-input-number",{attrs:{precision:2,step:.1},model:{value:e.goodsInfo.goods_price,callback:function(t){e.$set(e.goodsInfo,"goods_price",t)},expression:"goodsInfo.goods_price"}})],1),o("el-form-item",{attrs:{label:"商品库存(个/斤)",prop:"goods_num","label-width":"125px"}},[o("el-input-number",{attrs:{label:"商品库存(个/斤)"},model:{value:e.goodsInfo.goods_num,callback:function(t){e.$set(e.goodsInfo,"goods_num",t)},expression:"goodsInfo.goods_num"}})],1),o("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品图片"}},[o("el-upload",{ref:"upload",attrs:{action:"/api/goods/upload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"auto-upload":!1,"file-list":e.fileListt,"on-success":e.onSuccess}},[o("i",{staticClass:"el-icon-plus"})]),o("el-dialog",{attrs:{visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("img",{attrs:{width:"100%",src:e.goodsImg,alt:""}})])],1),o("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"商品描述：",prop:"goods_introduction"}},[o("el-input",{ref:"goods_introduction",staticStyle:{width:"260%"},attrs:{placeholder:"请输入商品描述",autocomplete:"off",name:"goods_introduction",type:"textarea",rows:4},model:{value:e.goodsInfo.goods_introduction,callback:function(t){e.$set(e.goodsInfo,"goods_introduction",t)},expression:"goodsInfo.goods_introduction"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrUpdateGoods("addOrUpdateGoods")}}},[e._v("确 定")])],1)],1),o("el-table",{staticClass:"goodsTable",attrs:{data:e.goodsList,border:"",stripe:""}},[o("el-table-column",{attrs:{prop:"goods_img",label:"商品图片",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[o("el-carousel",{staticStyle:{width:"120px",margin:"0 auto"},attrs:{"indicator-position":"outside",arrow:"never",height:"120px"}},e._l(s.goods_img,(function(t,s){return o("el-carousel-item",{key:s},[o("img",{staticStyle:{width:"120px",height:"120px"},attrs:{src:""+e.srcUrl+t}})])})),1)]}}])}),o("el-table-column",{attrs:{prop:"goods_name",label:"商品名称",align:"center",width:"135"}}),o("el-table-column",{attrs:{label:"商品分类",align:"center",width:"125"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[o("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(s.secondaryCategory.oneCategory.category_name))]),o("span",{staticStyle:{"margin-right":"5px"}},[e._v("/")]),o("span",[e._v(e._s(s.secondaryCategory.category_name))])]}}])}),o("el-table-column",{attrs:{prop:"goods_price",label:"商品单价(元)",align:"center",width:"135"}}),o("el-table-column",{attrs:{prop:"goods_num",label:"商品库存(个/斤)",align:"center",width:"135"}}),o("el-table-column",{attrs:{prop:"goods_introduction",label:"商品描述",align:"center"}}),o("el-table-column",{attrs:{prop:"goods_state",label:"商品状态",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"上架","inactive-text":"下架"},on:{change:function(t){return e.changeGoodsStatus(s,t)}},model:{value:s.goods_state,callback:function(t){e.$set(s,"goods_state",t)},expression:"row.goods_state"}})]}}])}),o("el-table-column",{attrs:{label:"设置",align:"center",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[o("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.openUpdateGoods(s)}}},[e._v("修改")]),o("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteGoods(s)}}},[e._v("删除")])]}}])})],1),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{"current-page":e.pageNum,"pager-count":5,"page-sizes":[3,5,7],"page-size":e.pageSize,layout:" prev, pager,  next, sizes,jumper,->,total",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getGoodsList}})],1)],1)},a=[],n=o("5530"),i=o("b85c"),r=o("c7eb"),c=o("1da1"),d=(o("ac1f"),o("00b4"),o("99af"),o("b0c0"),o("2f62")),l={name:"Goods",data:function(){var e=function(e,t,o){var s=/^[\u4E00-\u9FA5A-Za-z0-9_]+$/;t?s.test(t)?o():o(new Error("商品名称要求不包括特殊字符")):o(new Error("商品名称不能为空！"))},t=function(e,t,o){t?o():o(new Error("商品分类不能为空！"))},o=function(e,t,o){t?o():o(new Error("商品单价不能为空！"))},s=function(e,t,o){t?o():o(new Error("商品库存不能为空！"))},a=function(e,t,o){t?o():o(new Error("商品描述不能为空"))};return{searchObj:{goods_name:"",category1Id:null,category2Id:null},tempSearchObj:{goods_name:"",category1Id:null,category2Id:null},goodsInfo:{id:null,goods_name:"",goods_num:null,goods_price:null,goods_introduction:"",goods_category_id:null,goods_img:[]},category11Id:null,category22List:[],fileListt:[],goodsImg:"",pageNum:1,pageSize:5,titleName:"新增商品",dialogFormVisible:!1,dialogVisible:!1,addOrUpdateGoodsRules:{goods_name:[{required:!0,trigger:"blur",validator:e}],goods_category_id:[{required:!0,trigger:"blur",validator:t}],goods_price:[{required:!0,trigger:"blur",validator:o}],goods_num:[{required:!0,trigger:"blur",validator:s}],goods_introduction:[{required:!0,trigger:"blur",validator:a}]}}},mounted:function(){this.getGoodsList(),this.getCategoryList()},methods:{getGoodsList:function(){var e=arguments,t=this;return Object(c["a"])(Object(r["a"])().mark((function o(){var s,a,n,i,c,d,l,g;return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(s=e.length>0&&void 0!==e[0]?e[0]:1,t.pageNum=s,a=t.pageSize,n=t.pageNum,i=t.tempSearchObj,c=i.goods_name,d=i.category1Id,l=i.category2Id,g={pageSize:a,pageNum:n},c&&Object.assign(g,{goods_name:c}),d&&Object.assign(g,{category1Id:d}),l&&Object.assign(g,{goods_category_id:l}),o.prev=8,!d||l){o.next=14;break}return o.next=12,t.$store.dispatch("goods/getCategorySearchList",g);case 12:o.next=16;break;case 14:return o.next=16,t.$store.dispatch("goods/getGoodsList",g);case 16:t.$message({type:"success",message:"获取商品列表成功"}),o.next=22;break;case 19:o.prev=19,o.t0=o["catch"](8),t.$message({type:"error",message:o.t0});case 22:case"end":return o.stop()}}),o,null,[[8,19]])})))()},getCategoryList:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("category/getCategoryList");case 3:e.$message({type:"success",message:"获取商品分类列表成功"}),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.$message({type:"error",message:t.t0});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},handleSizeChange:function(e){this.pageSize=e,this.getGoodsList()},findGoods:function(){var e=this.searchObj,t=e.goods_name,o=e.category1Id,s=e.category2Id;this.tempSearchObj={goods_name:t,category1Id:o,category2Id:s},this.getGoodsList()},resetSearch:function(){this.searchObj={goods_name:"",category1Id:null,category2Id:null},this.tempSearchObj={goods_name:"",category1Id:null,category2Id:null},this.getGoodsList()},closeDialog:function(){this.dialogFormVisible=!1,this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.category11Id=null,this.category22List=[],this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null,this.fileListt=[],this.$refs.addOrUpdateGoods.resetFields()},onSuccess:function(e,t,o){this.fileListt=o,this.goodsInfo.goods_img.push(e.result.goodsImg)},handleRemove:function(e,t){this.fileListt=t},handlePictureCardPreview:function(e){this.goodsImg=e.url,this.dialogVisible=!0},openAddGoods:function(){this.titleName="新增商品",this.dialogFormVisible=!0,this.fileListt=[],this.category11Id=null,this.category22List=[],this.goodsInfo.goods_name="",this.goodsInfo.goods_category_id=null,this.goodsInfo.goods_introduction="",this.goodsInfo.goods_price=null,this.goodsInfo.goods_num=null,this.goodsInfo.goods_img=[],this.goodsInfo.id=null},openUpdateGoods:function(e){this.dialogFormVisible=!0,this.titleName="修改商品";var t,o=Object(i["a"])(e.goods_img);try{for(o.s();!(t=o.n()).done;){var s=t.value,a={name:"".concat(s),url:"".concat(this.srcUrl).concat(s)};this.fileListt.push(a)}}catch(n){o.e(n)}finally{o.f()}this.goodsInfo.goods_name=e.goods_name,this.goodsInfo.goods_category_id=e.goods_category_id,this.goodsInfo.goods_introduction=e.goods_introduction,this.goodsInfo.goods_price=e.goods_price,this.goodsInfo.goods_num=e.goods_num,this.goodsInfo.goods_img=e.goods_img,this.category22List=[],this.category11Id=e.secondaryCategory.oneCategory.id,this.goodsInfo.id=e.id},addOrUpdateGoods:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(o){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!o){e.next=5;break}return e.next=3,t.$refs.upload.submit();case 3:setTimeout(Object(c["a"])(Object(r["a"])().mark((function e(){var o,s,a,c,d,l,g,u,p,m,f,h;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,o=t.goodsInfo,s=o.goods_name,a=o.goods_price,c=o.goods_num,d=o.goods_introduction,l=o.goods_category_id,g=o.goods_img,u={goods_name:s,goods_price:a,goods_num:c,goods_introduction:d,goods_category_id:l,goods_img:"".concat(g)},"新增商品"!=t.titleName){e.next=8;break}return e.next=6,t.$store.dispatch("goods/addGoods",u);case 6:e.next=15;break;case 8:u.goods_img=[],p=Object(i["a"])(t.fileListt);try{for(p.s();!(m=p.n()).done;)f=m.value,f.response?u.goods_img.push(f.response.result.goodsImg):u.goods_img.push(f.name)}catch(r){p.e(r)}finally{p.f()}return u.goods_img="".concat(u.goods_img),h=Object(n["a"])({id:t.goodsInfo.id},u),e.next=15,t.$store.dispatch("goods/updateGoods",h);case 15:t.$message({type:"success",message:"".concat(t.titleName,"成功")}),t.getGoodsList(t.pageNum),t.closeDialog(),e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](0),t.$message({type:"error",message:e.t0});case 23:case"end":return e.stop()}}),e,null,[[0,20]])}))),500),t.dialogFormVisible=!1;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},changeGoodsStatus:function(e,t){var o=this;return Object(c["a"])(Object(r["a"])().mark((function s(){var a,n,i;return Object(r["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a="",n=0,t?(n=1,a="上架"):(a="下架",n=0),i={id:e.id,goods_state:n},s.prev=4,s.next=7,o.$store.dispatch("goods/updateGoodsStatus",i);case 7:o.$message({type:"success",message:"".concat(a,"成功")}),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](4),o.$message({type:"error",message:s.t0});case 13:case"end":return s.stop()}}),s,null,[[4,10]])})))()},deleteGoods:function(e){var t=this;return Object(c["a"])(Object(r["a"])().mark((function o(){return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:t.$confirm("确定删除商品 '".concat(e.goods_name,"' 吗?"),"提示",{type:"warning"}).then(Object(c["a"])(Object(r["a"])().mark((function o(){return Object(r["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,t.$store.dispatch("goods/deleteGoods",{ids:[e.id]});case 2:o.sent,t.getGoodsList(1===t.goodsList.length?t.pageNum-1:t.pageNum),t.$message({type:"success",message:"删除商品成功"});case 5:case"end":return o.stop()}}),o)})))).catch((function(e){"cancel"==e?t.$message.info("已取消删除"):t.$message({type:"error",message:e})}));case 1:case"end":return o.stop()}}),o)})))()}},computed:Object(n["a"])({},Object(d["c"])({goodsList:function(e){return e.goods.goodsList},total:function(e){return e.goods.total},category1List:function(e){return e.category.category1List},category2List:function(e){return e.category.category2List}})),watch:{category11Id:function(){this.category22List=this.category1List[this.category11Id-1<0?0:this.category11Id-1].secondaryCategory||[]}}},g=l,u=(o("4ee6"),o("59f2"),o("2877")),p=Object(u["a"])(g,s,a,!1,null,"64fa702d",null);t["default"]=p.exports},"86e8":function(e,t,o){}}]);